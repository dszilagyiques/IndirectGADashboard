{
  "permissions": {
    "allow": [
      "Bash(python main.py:*)",
      "Bash(head:*)",
      "Bash(python build_dashboard.py:*)",
      "Bash(copy \"outputs\\\\Indirect G&A Dashboard.html\" index.html)",
      "Bash(powershell.exe -Command \"cd ''C:\\\\Users\\\\dszilagyi\\\\source\\\\repos\\\\IndirectGandADashboard''; python -c \"\"\nimport time\n\n# Test direct calamine without pandas overhead\nt0 = time.time\\(\\)\nfrom python_calamine import CalamineWorkbook\nworkbook = CalamineWorkbook.from_path\\(''input/YTD Indirect-G&A Cost.xlsx''\\)\nsheet = workbook.get_sheet_by_name\\(''Cost Code Detail Report''\\)\ndata = sheet.to_python\\(\\)\nt_direct = time.time\\(\\) - t0\nprint\\(f''Direct calamine: {t_direct:.2f}s \\({len\\(data\\)-1} rows\\)''\\)\n\n# Test polars if available\ntry:\n    import polars as pl\n    t0 = time.time\\(\\)\n    df = pl.read_excel\\(''input/YTD Indirect-G&A Cost.xlsx'', sheet_name=''Cost Code Detail Report'', engine=''calamine''\\)\n    t_polars = time.time\\(\\) - t0\n    print\\(f''Polars+calamine: {t_polars:.2f}s \\({len\\(df\\)} rows\\)''\\)\nexcept Exception as e:\n    print\\(f''Polars error: {e}''\\)\n\"\"\")",
      "Bash(powershell.exe -Command \"cd ''C:\\\\Users\\\\dszilagyi\\\\source\\\\repos\\\\IndirectGandADashboard''; python -c \"\"\nimport time\n\n# Test polars with fastexcel\nimport polars as pl\nt0 = time.time\\(\\)\ndf = pl.read_excel\\(''input/YTD Indirect-G&A Cost.xlsx'', sheet_name=''Cost Code Detail Report'', engine=''calamine''\\)\nt_polars = time.time\\(\\) - t0\nprint\\(f''Polars+calamine: {t_polars:.2f}s \\({len\\(df\\)} rows\\)''\\)\n\n# Test full pipeline with polars\nt0 = time.time\\(\\)\n\n# Vectorized column derivation with expressions\ndf = df.filter\\(pl.col\\(''Document Type''\\) != ''Grand Total''\\)\n\n# Extract cost type code prefix efficiently\ncost_type = pl.col\\(''Cost Type''\\).cast\\(pl.Utf8\\).str.split\\('' - ''\\).list.first\\(\\).str.strip_chars\\(\\)\n\ndf = df.with_columns\\([\n    pl.when\\(cost_type.str.starts_with\\(''61''\\)\\).then\\(pl.lit\\(''Labor Costs''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''62''\\)\\).then\\(pl.lit\\(''Travel & Per Diem''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''64''\\)\\).then\\(pl.lit\\(''Fleet & Materials''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''65''\\)\\).then\\(pl.lit\\(''Facilities & Services''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''67''\\)\\).then\\(pl.lit\\(''Equipment Costs''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''693''\\)\\).then\\(pl.lit\\(''Allocation Credits''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''69''\\)\\).then\\(pl.lit\\(''Other Allocations''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''71''\\) | cost_type.str.starts_with\\(''72''\\)\\).then\\(pl.lit\\(''Corporate Overhead''\\)\\)\n      .when\\(cost_type.str.starts_with\\(''73''\\) | cost_type.str.starts_with\\(''74''\\) | cost_type.str.starts_with\\(''75''\\)\\).then\\(pl.lit\\(''G&A & Other''\\)\\)\n      .otherwise\\(pl.lit\\(''Other''\\)\\)\n      .alias\\(''Category''\\),\n    cost_type.str.starts_with\\(''693''\\).alias\\(''Is_Allocation''\\)\n]\\)\n\n# Write CSV\ncsv_data = df.write_csv\\(\\)\nt_pipeline = time.time\\(\\) - t0\nprint\\(f''Full polars pipeline: {t_pipeline:.2f}s \\({len\\(csv_data\\)/1024/1024:.1f}MB CSV\\)''\\)\n\"\"\")",
      "Bash(powershell.exe -Command \"cd ''C:\\\\Users\\\\dszilagyi\\\\source\\\\repos\\\\IndirectGandADashboard''; python test_perf.py\")",
      "Bash(powershell.exe -Command \"cd ''C:\\\\Users\\\\dszilagyi\\\\source\\\\repos\\\\IndirectGandADashboard''; python build_dashboard.py --clear-cache 2>&1\")"
    ]
  }
}
